function closeModal(){clearForm(form),modal.classList.remove("modal--show"),fbBtn.focus()}function validate(e){var o=e.querySelectorAll("input, textarea"),a=!0;return o.forEach(function(e,o){0===e.value.length&&(e.classList.add("ipt__field--error"),a=!1),e.addEventListener("keydown",function(e){this.classList.remove("ipt__field--error")})}),a}function clearForm(e){var o=e.querySelectorAll("input, textarea");o.forEach(function(e,o){e.classList.remove("ipt__field--error")}),modal.classList.remove("modal--error"),e.reset()}function initMap(){var e=new ymaps.Map("map",{center:[59.939099,30.321523],zoom:17}),o=new ymaps.Placemark([59.938631,30.323055],{hintContent:"NЁRDS DESIGN STUDIO",balloonContent:"191186, Санкт-Петербург, ул. Б. Конюшенная, д. 19/8"},{iconLayout:"default#image",iconImageHref:"img/pictures/map-marker.png",iconImageSize:[231,190],iconImageOffset:[-40,-220]});e.behaviors.disable(["drag","scrollZoom"]),e.controls.remove("default").remove("rulerControl"),e.geoObjects.add(o)}"function"!=typeof NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach);var fbBtn=document.querySelector("#feedback"),modal=document.querySelector("#modal"),modalClose=modal.querySelector(".modal__close"),form=modal.querySelector(".form"),fio=form.querySelector("[name=fio]"),email=form.querySelector("[name=email]"),text=form.querySelector("[name=text]"),isStorageSupport=!0,storage="";try{var data=localStorage.getItem("data");storage=JSON.parse(data)}catch(err){isStorageSupport=!1}fbBtn.addEventListener("click",function(e){e.preventDefault(),modal.classList.add("modal--show"),storage?(fio.value=storage.fio,email.value=storage.email,text.focus()):fio.focus(),window.addEventListener("keydown",function(e){27===e.keyCode&&(e.preventDefault(),modal.classList.contains("modal--show")&&closeModal())})}),modal.addEventListener("click",function(e){e.target.classList.contains("modal")&&closeModal()}),modalClose.addEventListener("click",function(e){e.preventDefault(),closeModal()}),form.addEventListener("submit",function(e){if(validate(form)){if(isStorageSupport){var o=JSON.stringify({fio:fio.value,email:email.value});localStorage.setItem("data",o)}}else modal.classList.remove("modal--error"),modal.offsetWidth=modal.offsetWidth,modal.classList.add("modal--error")}),ymaps.ready(initMap);